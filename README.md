# GoDockerfile: A Dockerfile Builder Library for Go

[![Go Report Card](https://goreportcard.com/badge/github.com/gdesouza/godockerfile)](https://goreportcard.com/report/github.com/gdesouza/godockerfile)
[![Go.Dev](https://img.shields.io/badge/go.dev-reference-007d9c?logo=go&logoColor=white)](https://pkg.go.dev/github.com/gdesouza/godockerfile)

GoDockerfile is a Go library that provides a simple and expressive way to programmatically generate Dockerfiles. It's designed to help you create dynamic and complex Dockerfiles with ease, directly from your Go applications.

## Overview

Instead of writing static `Dockerfile` files, you can use GoDockerfile to define your Docker image configuration in Go. This allows you to:

*   **Dynamically generate Dockerfiles:** Create Dockerfiles based on configuration, environment, or user input.
*   **Reduce errors:** Avoid syntax errors and typos in your Dockerfiles.
*   **Reuse and compose:** Create reusable Dockerfile components and compose them to build complex images.
*   **Integrate with your Go projects:** Seamlessly integrate Dockerfile generation into your existing Go-based tools and workflows.

## Features

*   Fluent API for defining Dockerfile instructions.
*   Support for all major Dockerfile commands (`FROM`, `RUN`, `COPY`, `CMD`, etc.).
*   Easy to add and chain commands.
*   Automatic generation of a valid `Dockerfile`.

## Installation

To use GoDockerfile in your project, you can use `go get`:

```bash
go get github.com/gdesouza/godockerfile
```

## Usage

Here's a simple example of how to use GoDockerfile to generate a `Dockerfile` for a basic Go application:

```go
package main

import (
	"fmt"
	"log"

	"github.com/gdesouza/godockerfile/builder"
)

func main() {
	// Create a new Dockerfile configuration
	config := &builder.DockerfileConfig{
		BaseImage:    "golang:1.21-alpine",
		Workspace:    "/app",
		ExposePort:   true,
		AppPort:      8080,
		BuildCommand: "go build -o myapp .",
		RunCommand:   "./myapp",
		CopyFiles: []builder.CopyInstruction{
			{Origin: "go.mod", Destination: "."},
			{Origin: "go.sum", Destination: "."},
			{Origin: "main.go", Destination: "."},
		},
	}

	// Generate the Dockerfile content
	dockerfileContent, err := config.GenerateDockerfileContent()
	if err != nil {
		log.Fatalf("Error generating Dockerfile: %v", err)
	}

	// Print the generated Dockerfile
	fmt.Println(dockerfileContent)
}
```

When you run this Go program, it will output the following `Dockerfile` content:

```dockerfile
# Auto-generated Dockerfile
# Do not edit this file manually
# Dockerbot version: 
FROM golang:1.21-alpine

COPY go.mod .
COPY go.sum .
COPY main.go .

RUN go build -o myapp .

EXPOSE 8080

WORKDIR /app

ENTRYPOINT ["./myapp"]
```

## Building from Source

If you want to contribute to the project or build it from source, you can clone the repository and use `go build`:

```bash
git clone https://github.com/gdesouza/godockerfile.git
cd godockerfile
go build ./...
```

## Testing

To run the tests for the project, use `go test`:

```bash
go test ./...
```

## Contributing

Contributions are welcome! Please feel free to submit a pull request or open an issue.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
